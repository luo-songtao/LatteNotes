<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">

  <title>CentOS7安装DockerCE并配置远程连接</title>
  <link rel="stylesheet" href="/notes/css/main.css">

  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>CentOS7安装DockerCE并配置远程连接 | LuoSongtao-Blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="CentOS7安装DockerCE并配置远程连接" />
<meta name="author" content="LuoSongtao" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="CentOS7安装Docker" />
<meta property="og:description" content="CentOS7安装Docker" />
<link rel="canonical" href="http://0.0.0.0:4000/notes/CentOS7%E5%AE%89%E8%A3%85DockerCE%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5" />
<meta property="og:url" content="http://0.0.0.0:4000/notes/CentOS7%E5%AE%89%E8%A3%85DockerCE%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5" />
<meta property="og:site_name" content="LuoSongtao-Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-01T00:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2018-07-01T00:00:00-05:00","dateModified":"2018-07-01T00:00:00-05:00","author":{"@type":"Person","name":"LuoSongtao"},"description":"CentOS7安装Docker","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/notes/CentOS7%E5%AE%89%E8%A3%85DockerCE%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"},"@type":"BlogPosting","url":"http://0.0.0.0:4000/notes/CentOS7%E5%AE%89%E8%A3%85DockerCE%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5","headline":"CentOS7安装DockerCE并配置远程连接","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <div id="wrapper">
    <header>
  <div style="text-align: center;">
    <div>
      <a id="username" href="/notes/">
      
      <span style="font-size: x-large;color: #b5e853">luosongtao@home:~$</span>
      </a>
      
<div id="search">
	<input type="text" id="search-input" placeholder="Command.." style="vertical-align:middle;">
	<ul id="results-container"></ul>
</div>

<!-- script pointing to jekyll-search.js -->
<script src="/notes/assets/js/simple-jekyll-search.min.js"></script>
<script async src="/notes/searchdata.js"></script>

    </div>
  </div>
  <div class="header-links">
      <a href="/notes/archive"><h2 class="header-link">Archive</h2></a>
<a href="/notes/about"><h2 class="header-link">About</h2></a>
<a href="/notes/atom.xml"><h2 class="header-link">RSS</h2></a>
  </div>

</header>
    <div class="container">
        <article>
  <h2>CentOS7安装DockerCE并配置远程连接</h2>
  <time datetime="2018-07-01T00:00:00-05:00" class="by-line">01 Jul 2018</time>
  <h3 id="centos7安装docker">CentOS7安装Docker</h3>

<p>CentOS7上安装Docker CE的步骤和官网几乎一样，只是这里采用的是阿里的软件源，加速器也是使用阿里提供的加速器(免费)。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># step 1: 安装必要的一些系统工具</span>
<span class="nb">sudo </span>yum <span class="nb">install</span> <span class="nt">-y</span> yum-utils device-mapper-persistent-data lvm2
<span class="c"># Step 2: 添加软件源信息</span>
<span class="nb">sudo </span>yum-config-manager <span class="nt">--add-repo</span> http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
<span class="c"># Step 3: 更新并安装Docker-CE</span>
<span class="nb">sudo </span>yum makecache fast
<span class="nb">sudo </span>yum <span class="nt">-y</span> <span class="nb">install </span>docker-ce

<span class="c"># 注意：</span>
<span class="c"># 官方软件源默认启用了最新的软件，您可以通过编辑软件源的方式获取各个版本的软件包。例如官方并没有将测试版本的软件源置为可用，您可以通过以下方式开启。同理可以开启各种测试版本等。</span>
<span class="c"># vim /etc/yum.repos.d/docker-ee.repo</span>
<span class="c">#   将[docker-ce-test]下方的enabled=0修改为enabled=1</span>
<span class="c">#</span>
<span class="c"># 安装指定版本的Docker-CE:</span>
<span class="c"># Step 1: 查找Docker-CE的版本:</span>
<span class="c"># yum list docker-ce.x86_64 --showduplicates | sort -r</span>
<span class="c">#   Loading mirror speeds from cached hostfile</span>
<span class="c">#   Loaded plugins: branch, fastestmirror, langpacks</span>
<span class="c">#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            docker-ce-stable</span>
<span class="c">#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            @docker-ce-stable</span>
<span class="c">#   docker-ce.x86_64            17.03.0.ce-1.el7.centos            docker-ce-stable</span>
<span class="c">#   Available Packages</span>
<span class="c"># Step2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.0.ce.1-1.el7.centos)</span>
<span class="c"># sudo yum -y install docker-ce-[VERSION]</span>

<span class="c"># 启动docker</span>
<span class="nb">sudo </span>service docker start
<span class="c"># 查看docker</span>
<span class="nb">sudo </span>docker version
</code></pre></div></div>
<p>镜像加速器配置，参考：<a href="https://yq.aliyun.com/articles/29941">阿里云提供的加速器配置</a>，登录<a href="https://cr.console.aliyun.com/">容器Hub服务</a>进行获取并在<code class="highlighter-rouge">/etc/docker/daemon.json</code>中配置</p>

<h3 id="centos7中配置docker远程连接">CentOS7中配置Docker远程连接</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Step 1: 添加远程连接配置</span>
<span class="nb">sudo </span>vi /etc/docker/daemon.json
<span class="c"># 增加hosts配置项："hosts":{"tcp://0.0.0.0:2375", "unix:///var/run/docker.sock"}</span>
<span class="c"># 注意：端口可以随意改，通常使用2375；远程连接使用的tcp协议，因此操作系统还需要打开2375端口</span>
<span class="o">{</span>
  <span class="s2">"registry-mirrors"</span>: <span class="o">[</span><span class="s2">"填写你的加速器地址"</span><span class="o">]</span>,
  <span class="s2">"hosts"</span>: <span class="o">[</span>
    <span class="s2">"tcp://0.0.0.0:2375"</span>,
    <span class="s2">"unix:///var/run/docker.sock"</span>
  <span class="o">]</span>
<span class="o">}</span>

<span class="c"># Step 2: 重启docker</span>
<span class="nb">sudo </span>service restart docker

<span class="c"># centos7查看端口开放情况</span>
firewall-cmd <span class="nt">--list-ports</span>
<span class="c"># centos7放行端口</span>
<span class="c"># 注意：--permanent意为重启也生效</span>
firewall-cmd <span class="nt">--zone</span><span class="o">=</span>public <span class="nt">--add-port</span><span class="o">=</span>80/tcp <span class="nt">--permanent</span>
<span class="c"># centos7关闭端口放行</span>
firewall-cmd <span class="nt">--remove-port</span><span class="o">=</span>80/tcp <span class="nt">--permanent</span>

<span class="c"># 检验配置是否成功</span>
<span class="c"># 注意：其他机器连接需使用具体的ip地址</span>
<span class="nb">sudo </span>docker <span class="nt">-H</span> <span class="s2">"127.0.0.1:2375"</span> images
</code></pre></div></div>

<p>因笔者所用python环境、及其他环境，现目前全是基于docker镜像，因此经常用到Pycharm+Docker的方式进行开发环境搭建，需要开启远程连接配置。</p>

</article>
      <section id="main_content">
        <ul>
            
        </ul>
      </section>
    </div>
  </div>
   <footer>
  <a href="/notes/">
    <span>
        <b>LuoSongtao</b>
    </span>
    
    <span>© 2019</span>
  </a>
</footer>

  
</body>

</html>