<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="generator" content="Jekyll">

  <title>基于Ubuntu18.04的shadowsocks-qt5安装并配置PAC规则</title>
  <link rel="stylesheet" href="/notes/css/main.css">

  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed" /> <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>基于Ubuntu18.04的shadowsocks-qt5安装并配置PAC规则 | LuoSongtao-Blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="基于Ubuntu18.04的shadowsocks-qt5安装并配置PAC规则" />
<meta name="author" content="LuoSongtao" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="大家应该比较清楚，对于我们程序员来说，翻越某墙的本领几乎已成为我们的基础技能之一。" />
<meta property="og:description" content="大家应该比较清楚，对于我们程序员来说，翻越某墙的本领几乎已成为我们的基础技能之一。" />
<link rel="canonical" href="http://0.0.0.0:4000/notes/%E5%9F%BA%E4%BA%8EUbuntu18.04%E7%9A%84shadowsocks-qt5%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AEPAC%E8%A7%84%E5%88%99" />
<meta property="og:url" content="http://0.0.0.0:4000/notes/%E5%9F%BA%E4%BA%8EUbuntu18.04%E7%9A%84shadowsocks-qt5%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AEPAC%E8%A7%84%E5%88%99" />
<meta property="og:site_name" content="LuoSongtao-Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-06T03:00:00-05:00" />
<script type="application/ld+json">
{"datePublished":"2018-07-06T03:00:00-05:00","dateModified":"2018-07-06T03:00:00-05:00","author":{"@type":"Person","name":"LuoSongtao"},"description":"大家应该比较清楚，对于我们程序员来说，翻越某墙的本领几乎已成为我们的基础技能之一。","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/notes/%E5%9F%BA%E4%BA%8EUbuntu18.04%E7%9A%84shadowsocks-qt5%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AEPAC%E8%A7%84%E5%88%99"},"@type":"BlogPosting","url":"http://0.0.0.0:4000/notes/%E5%9F%BA%E4%BA%8EUbuntu18.04%E7%9A%84shadowsocks-qt5%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AEPAC%E8%A7%84%E5%88%99","headline":"基于Ubuntu18.04的shadowsocks-qt5安装并配置PAC规则","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>
  <div id="wrapper">
    <header>
  <div style="text-align: center;">
    <div>
      <a id="username" href="/notes/">
      
      <span style="font-size: x-large;color: #b5e853">luosongtao@home:~$</span>
      </a>
      
<div id="search">
	<input type="text" id="search-input" placeholder="Command.." style="vertical-align:middle;">
	<ul id="results-container"></ul>
</div>

<!-- script pointing to jekyll-search.js -->
<script src="/notes/assets/js/simple-jekyll-search.min.js"></script>
<script async src="/notes/searchdata.js"></script>

    </div>
  </div>
  <div class="header-links">
      <a href="/notes/archive"><h2 class="header-link">Archive</h2></a>
<a href="/notes/about"><h2 class="header-link">About</h2></a>
<a href="/notes/atom.xml"><h2 class="header-link">RSS</h2></a>
  </div>

</header>
    <div class="container">
        <article>
  <h2>基于Ubuntu18.04的shadowsocks-qt5安装并配置PAC规则</h2>
  <time datetime="2018-07-06T03:00:00-05:00" class="by-line">06 Jul 2018</time>
  <p>大家应该比较清楚，对于我们程序员来说，翻越某墙的本领几乎已成为我们的基础技能之一。</p>

<p>因为很多我们所使用的服务或者要查看某些服务的官方文档，直接访问，要么没法打开，要么就慢得出奇。</p>

<p>不过还好，<a href="https://bwh1.net/index.php">它</a>的出现让笔者方便了不少，便宜实惠又好用。</p>

<p>一般在windows、MacOS、Android、IOS等平台上，都是有对应的图形化ss客户端。在<a href="https://github.com/shadowsocks">github</a>上下载，直接安装就能使用。并且基本自带PAC功能。</p>

<p>不过在DeskTop的Linux上使用图形化ss客户端，我们就要费点周折了。</p>

<p>因为只能自行编译安装shadowsocks-qt5，其实其<a href="https://github.com/shadowsocks/shadowsocks-qt5/wiki/Compiling">安装教程</a>，github上已经非常详尽了，只不过笔者在安装依赖环境时也是遇到些问题，这里就针对我们常用的桌面版Liunx(Ubuntu18.04)，总结以下安装过程。</p>

<h3 id="编译和安装libqtshadowsocks">编译和安装libQtShadowsocks</h3>

<p>依赖环境：</p>

<ul>
  <li>Qt &gt;= 5.5</li>
  <li>Botan-2 &gt;= 2.3.0
    <ul>
      <li>Or Botan-1.10 (Not recommended)</li>
    </ul>
  </li>
  <li>CMake &gt;= 3.1</li>
  <li>A C++ Compiler that supports C++14 features (i.e. GCC &gt;= 4.9)</li>
</ul>

<p>建议：先安装一个aptitude(<code class="highlighter-rouge">sudo apt-get install -y aptitude</code>)，因为它除了支持apt-get的所有命令外，还有比如search这样的命令，对于确定模块的完整名称非常有帮助</p>

<p>Step 1: 安装GCC</p>

<ul>
  <li>一般情况下，直接<code class="highlighter-rouge">sudo aptitude -y install gcc</code>即可</li>
</ul>

<p>Step 2: 安装CMake</p>

<ul>
  <li>一般情况下，直接<code class="highlighter-rouge">sudo aptitude -y install cmake</code>即可</li>
</ul>

<p>Step 3: 安装Qt5</p>

<ul>
  <li>下载<a href="https://download.qt.io/official_releases/qt/">Qt5安装包</a>，建议5.9及以上
    <ul>
      <li>找到linux版本的安装包下载</li>
      <li>利用<code class="highlighter-rouge">chmod +x 安装包名称</code>添加可执行权限</li>
      <li><code class="highlighter-rouge">./安装包名称</code>一路安装即可（注意：要把Qt5勾选上）</li>
    </ul>
  </li>
</ul>

<p>Step 4: 安装Botan</p>

<ul>
  <li>一般情况下，直接<code class="highlighter-rouge">sudo aptitude -y install botan1.10-dbg</code>即可
    <ul>
      <li>注意1：官方建议是安装2版本。</li>
      <li>注意2：如果使用2版本的botan，之后<code class="highlighter-rouge">cmake</code>命令时还需要添加<code class="highlighter-rouge">-DUSE_BOTAN2=ON</code>。但我尝试直接安装botan2版本，但<code class="highlighter-rouge">cmake</code>没有成功过。原因应该是我没安装正确的版本，因为<code class="highlighter-rouge">aptitude search botan</code>可以看到很多个版本的botan。</li>
    </ul>
  </li>
</ul>

<p>Final Step: 编译和安装</p>

<ul>
  <li>
    <p>clone或直接下载 <a href="https://github.com/shadowsocks/libQtShadowsocks.git">libQtShadowsocks</a> 的stable分支</p>
  </li>
  <li>
    <p>进入代码目录（<code class="highlighter-rouge">CMakeLists.txt</code>所在路径）</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">mkdir </span>build <span class="o">&amp;&amp;</span> <span class="nb">cd </span>build
  cmake .. <span class="nt">-DCMAKE_INSTALL_PREFIX</span><span class="o">=</span>/usr
  make <span class="nt">-j4</span>
  <span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="编译和安装shadowsocks-qt5">编译和安装shadowsocks-qt5</h3>

<p>依赖环境：</p>
<ul>
  <li>cmake &gt;= 3.1.0</li>
  <li>qt5-qtbase-gui &gt;= 5.2 (qtbase5 in Debian/Ubuntu)</li>
  <li>qrencode (libqrencode in Debian/Ubuntu)</li>
  <li>libQtShadowsocks &gt;= 1.10.0 (libqtshadowsocks in Debian/Ubuntu. DON’T use the trunk code)</li>
  <li>zbar (libzbar0 or libzbar in Debian/Ubuntu)</li>
  <li>libappindicator (libappindicator1 in Debian/Ubuntu)</li>
</ul>

<p>Step 1: 安装libQtShadowsocks</p>

<ul>
  <li>见前一节</li>
</ul>

<p>Step 2: 安装CMake</p>

<ul>
  <li>同上</li>
</ul>

<p>Step 3: 安装qrencode</p>

<ul>
  <li>一般情况下，直接<code class="highlighter-rouge">sudo aptitude -y install libqrencode-dev</code>即可</li>
</ul>

<p>Step 4: 安装zbar</p>

<ul>
  <li>一般情况下，直接<code class="highlighter-rouge">sudo aptitude -y install libzbar-dev</code>即可
    <ul>
      <li>注意：直接安装<code class="highlighter-rouge">libzbar-dev</code></li>
    </ul>
  </li>
</ul>

<p>Step 4: 安装libappindicator</p>

<ul>
  <li>一般情况下，直接<code class="highlighter-rouge">sudo aptitude -y install libappindicator1</code>即可</li>
</ul>

<p>Final Step：编译和安装</p>

<ul>
  <li>
    <p>clone或直接下载 <a href="https://github.com/shadowsocks/shadowsocks-qt5.git">shadowsocks-qt5</a> 的stable分支</p>
  </li>
  <li>
    <p>进入代码目录（<code class="highlighter-rouge">CMakeLists.txt</code>所在路径）</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">mkdir </span>build <span class="o">&amp;&amp;</span> <span class="nb">cd </span>build
  cmake .. <span class="nt">-DCMAKE_INSTALL_PREFIX</span><span class="o">=</span>/usr
  make <span class="nt">-j4</span>
  <span class="nb">sudo </span>make <span class="nb">install</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="配置shadowsocks-qt5">配置shadowsocks-qt5</h3>

<p>然后，就可以打开你的shadowsocks图形界面客户端了</p>

<ul>
  <li>
    <p>连接 » 添加 » 手动</p>

    <p><img src="/notes/assets/images/shadowsocks-Qt5.png" alt="图片" /></p>
  </li>
  <li>设置 » 常规设置
    <ul>
      <li>勾选登录时启动(开机自启)</li>
    </ul>
  </li>
  <li>Ubuntu中：
  <img src="/notes/assets/images/Ubuntu18.04配置手动代理.png" alt="配置手动代理" /></li>
</ul>

<p>但是此时，全局都是使用ss客户端进行代理，因此接下来，需要改为PAC模式，才能让我们更舒服的使用。</p>

<h3 id="配置pac上网规则">配置PAC上网规则</h3>

<p>依赖：<a href="https://github.com/JinnLynn/genpac">genpac</a></p>

<p>Step 1：安装pip工具(如有，请忽略）。默认Ubuntu18.04只有python365，且不具有pip工具。</p>

<ul>
  <li>使用<code class="highlighter-rouge">get-pip.py安装</code>，只会安装pip(而<code class="highlighter-rouge">sudo apt-get install python3-pip</code>，通常会额外安装一个python解释器)
    <ul>
      <li><a href="https://pip.pypa.io/en/stable/installing/">安装方法</a>
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  curl https://bootstrap.pypa.io/get-pip.py <span class="nt">-o</span> get-pip.py
  python3 get-pip.py  
</code></pre></div>        </div>
      </li>
      <li>注意：建议安装一个新版本的python解释器使用，但会带来维护多版本python的问题，因此也考虑使用虚拟环境来操作</li>
    </ul>
  </li>
</ul>

<p>Step 2：安装genpac，并生成pac文件</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">pip install genpac</code></p>
  </li>
  <li>构建PAC文件
    <ul>
      <li>可在如home目录下创建一个PAC文件夹，专门存放PAC配置文件
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">mkdir</span> ~/PAC
  <span class="nb">cd</span> ~/PAC
  genpac <span class="nt">--pac-proxy</span> <span class="s2">"SOCKS5 127.0.0.1:1080"</span> <span class="nt">--gfwlist-proxy</span><span class="o">=</span><span class="s2">"SOCKS5 127.0.0.1:1080"</span> <span class="nt">--gfwlist-url</span><span class="o">=</span>https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt <span class="nt">--output</span><span class="o">=</span><span class="s2">"autoproxy.pac"</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>使用PAC文件实现非全局代理
    <ul>
      <li>将生成的<code class="highlighter-rouge">autoproxy.pac</code>文件所在绝对路径设置为自动代理的URL路径
  <img src="/notes/assets/images/配置pac模式非全局代理.png" alt="配置pac模式非全局代理" /></li>
      <li>同时注意：此时shadsocks-qt5中的代理配置，需要改为socks5模式</li>
    </ul>
  </li>
</ul>

<p>自此，安装配置完成，接下来尽情的上网吧</p>


</article>
      <section id="main_content">
        <ul>
            
        </ul>
      </section>
    </div>
  </div>
   <footer>
  <a href="/notes/">
    <span>
        <b>LuoSongtao</b>
    </span>
    
    <span>© 2019</span>
  </a>
</footer>

  
</body>

</html>