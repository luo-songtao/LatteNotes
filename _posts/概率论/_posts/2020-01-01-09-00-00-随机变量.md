---
layout: post
title: 概率论-随机变量
tags: [随机变量, 离散型随机变量]
category: ['probability-theory']
date: 2020-01-01 09:00:00
toc: true
---


## 随机变量

#### 定义

随机变量在进行试验时，相对于试验的实际结果而言，我们的兴趣往往集中与试验的某些函数。而这些定义在样本空间上的实值函数，称为随机变量(Random Variable)。

## 分布函数

对于随机变量$X$，如下定义的函数$F$

$$F(x) = P\lbrace X\le x\rbrace \qquad -\infty < x< \infty$$

称为X的累计分布函数(Cumulative Distribution Function)，简称分布函数

因此对任一给定实数$x$,分布函数为该随机变量$X$小于等于$x$的概率

已知$a\le b$，那么由于事件$\lbrace X \le a\rbrace$ 包含于事件$\lbrace X \le b\rbrace$，可知二者的概率关系为：$F(a)\le F(b)$,即**$F(x)$是单调非降函数**


## 离散型随机变量

若一个随机变量**最多有可数个**可能取值，那么称这个随机变量是离散的。

#### 概率质量函数(PMF)

对于离散随机变量，我们定义$X$的概率函数，离散随机变量中可称为概率质量函数(Probability Mass Function)$P(a)$为

$$p(a) = P(X=a)$$

**性质**
- $p(a)$最多在可数个a上取正值。即如果X的可能值为$x_1, x_2, ···$，那么：

$$\begin{aligned} p(x_i) &\ge 0 \qquad i=1,2,··· \\ p(x) &= 0 \qquad 其他x \end{aligned}$$

- 由于X必定取值于$\lbrace x_1, x_2, ··· \rbrace$，所以有：

$$\sum_{i=1}^{\infty}p(x_i)=1$$

#### 离散型随机变量的分布函数

离散型随机变量的分布函数可通过概率质量函数$p(a)$进行计算：

$$F(x) = \sum_{x\le a}p(x)$$

若X是一个离散型随机变量，其可能取值为$x_1,x_2,···$，其中$x_1<x_2<x_3<···$则它的分布函数是一个**阶梯函数**


## 期望

对于离散随机变量$X$，及其概率质量函数$p(x)$，那么$X$的期望(Expectation)或期望值(Expected Value)，记为$E(X)$：

$$E(x) = \sum_{x:p(x)>0}xp(x)$$

$X$的期望值就是X所有可能取值的一个加权平均，每个值的权重就是X中取该值x的概率

如果$X$为离散型的且取无穷个值，那么X的数学期望可定义为级数之和：

$$E(X) = \sum_{i=1}^{\infty}a_ip_i$$

并要求该级数必须收敛，且必须是绝对收敛。因为期望的取值不应与人为的排列次数有关。

如果$X$是一个离散型随机变量，其可能取值为$x_i,i\ge 1 $, 相应的取值概率为$p(x_i)$，那么对于任一实值函数g，都有：

$$E[g(X)] = \sum_ig(x_i)p(x_i)$$

若a和b是常数，则

$$E[aX+b] = aE[X] + b$$

随机变量X的期望$E[X]$，也称为$X$的均值(mean)，或者一阶矩(First Moment)，$E\[X^n\](n\ge 1)$称为$X$的$n$阶矩，且：

$$E[x^n] = \sum_{x:p(x)>0}x^np(x)$$


## 方差

如果随机变量$X$的期望为$u$，那么$X$的方差记为$Var(X)$，其定义为：

$$Var(X) = E[(x-u)^2]$$

方程的另一表达式：

$$\begin{aligned} Var(X) = E[(X-u)^2] &= \sum_x(x-u)^2p(x)  \\ &= \sum_x(x^2-2ux+u^2)p(x) \\ &=\sum_xx^2p(x)-2u\sum_xxp(x) + u^2\sum_xp(x) \\ &= E[x^2] - u^2 \\ &= E[X^2] - (E[X])^2 \end{aligned}$$

方差可以描述随机变量取值与均值的偏离程度或离散程度。

对于任意常数a和b，有下面的恒等式:

$$Var(aX+b) = a^2Var(X)$$

证明：

令$u = E[X]$

$$\begin{aligned} Var(aX+b) = E[(aX+b-au-b)] = E[a^2(X-u)^2] = a^2E[(X-u)^2] = a^2Var(X) \end{aligned}$$

## 伯努利随机变量

对于：

$$X = \left \lbrace \begin{matrix} &1 \qquad & 当试验结果为成功时 \\ &0 \qquad & 当试验结果为失败时  \end{matrix}  \right.$$

其中$p\in [0,1]$，是每次试验成功的概率。对于X的概率质量函数:

$$\begin{aligned} p(0) &= P(X=0) = 1-p \\ p(1) &= P(X=1) = p \end{aligned}$$

这样的随机变量$X$称为**伯努利随机变量**

## 二项随机变量 (Binomial)

假设现在进行$n$次**独立重复**试验，每次试验成功的概率是**p**，失败的概率是**1-p**。

如果$X$表示$n$次试验中成功的次数，那么称$X$为参数是$(n,p)$的**二项随机变量**。可见伯努利随机变量是参数$(1,p)$的二项随机变量。

二项随机变量的概率分布为：

$$p(i) = \left ( \begin{matrix} n \\ r \end{matrix}\right )p^i(1-p)^{n-i} \qquad i=0,1,2,···,n$$

#### 二项随机变量的性质

###### 期望与方差

首先：

$$\begin{aligned}E[X^k] &= \sum_i i^k p(i) \\ &= \sum_{i=0}^n i^k \left ( \begin{matrix} n \\ i \end{matrix}\right ) p^i (1-p)^{n-i} \\ &= \sum_{i=1}^n i^k \left ( \begin{matrix} n \\ i \end{matrix}\right ) p^i (1-p)^{n-i} \end{aligned}$$

根据恒等式：

$$i\left ( \begin{matrix} n \\ i \end{matrix}\right ) = n\left ( \begin{matrix} n-1 \\ i-1 \end{matrix}\right )$$

可得：

$$\begin{aligned}E[X^k] &= np\sum_{i=1}^n i^{k-1} \left ( \begin{matrix} n-1 \\ i-1 \end{matrix}\right ) p^{i-1} (1-p)^{n-i} \\ &= np\sum_{j=0}^{n-1} (j+1)^{k-1} \left ( \begin{matrix} n-1 \\ j \end{matrix}\right ) p^j (1-p)^{n-1-j} \qquad 令j=i-1 \\ &= npE[(Y+1)^{k+1}]\end{aligned}$$

其中Y是参数为(n-1, p)的二项随机变量。

令k=1，可得期望：

$$E(X) = np$$

再令k=2，可得：

$$E(X^2) = npE[(Y+1)] = np[(n-1)p+1]$$

因此可推出，方差：

$$Var(X) = E[X^2] - (E[X])^2 = np[(n-1)p+1] - (np)^2 = np(1-p)$$


如果X是一个参数为$(n,p)$的二项随机变量，其中$0<p<1$。那么当$k$从$0$到$n$时，$P(X=k)$单调递增，然后单调递减，当$k=[(n+1)p]$时取最大值。(这里表示小于等于$(n+1)p$的最大整数)

可通过对$P\lbrace X=k \rbrace/P\lbrace X=k-1 \rbrace $与1的大小关系推出

#### 二项随机变量分布函数的计算

$$P\lbrace X=k+1 \rbrace = \frac {p}{1-p} \frac {n-k}{k+1} P\lbrace X=k \rbrace$$


## 泊松随机变量 (Poisson)

如果一个取值是0,1,2,···的随机变量对某一个$\lambda > 0$，其概率分布为：

$$p(i) = P\lbrace X = i \rbrace = e^{-\lambda}\frac {\lambda^i}{i!}$$

则称该随机变量为服从参数是$\lambda$的泊松随机变量。

$$\sum_{i=0}^{\infty}p(i) = e^{-\lambda}\sum_{i=0}^{\infty}\frac {\lambda^i}{i!} = e^{-\lambda} e^{\lambda} = 1$$

当$n$足够大，$p$充分小，从而使得$np$保持适当的大小时，参数为$(n,p)$的二项随机变量可近似地看作是参数是$\lambda=np$的泊松随机变量


$$E[X] = \lambda$$

$$Var(X) = \lambda$$

#### 泊松范例

考虑n个事件，第i个事件发生的概率为$p_i，i=1,2,···,n$。如果所有$p_i$都很小，其试验或者独立或者弱相依，那么事件发生次数近似地服从参数为$$\sum_{i=1}^np_i$$的泊松分布


#### 泊松随机变量分布函数的计算

$$\frac {P\lbrace X=i+1 \rbrace}{P\lbrace X=i \rbrace } = \frac {\lambda}{i+1}$$


## 几何随机变量 (Geometric)

考虑在独立重复试验中，每次成功的概率为$p,(0<p<1)$，重复试验直到试验首次成功为止。

如果令$X$表示需要试验的次数，X若满足

$${P\lbrace X=n \rbrace} = (1-p)^{n-1}p \qquad n=1,2,···$$

则表示X是参数为p的几何随机变量


$$E[X] = \frac 1p$$

$$Var(x)= \frac {1-p}{p^2}$$

$$\sum_{n=1}^{\infty}P(X=n) = p\sum_{n=1}^{\infty}(1-p)^{n-1} = \frac {p}{1-(1-p)} = 1$$

## 负二项随机变量 (Negative Binomial)

假定独立重复试验中， 每次成功的概率为$p,(0<p<1)$，试验持续进行直到试验累计成功r次为止。

如果令$X$表示试验的总次数，X若满足

$${P\lbrace X=n \rbrace} = \left ( \begin{matrix} n-1 \\ r-1 \end{matrix} \right ) p^r(1-p)^{n-r} \qquad n=r, r+1,···$$

则表示X是参数为(r,p)的负二次随机变量。

注意：几何随机变量恰好是参数为(1,p)的负二项随机变量

$$E[X] = \frac rp$$

$$Var(X) = \frac {r(1-p)}{p^2}$$

$$\sum_{n=r}^{\infty}P\{ X=n\} = \sum_{n=r}^{\infty}\left ( \begin{matrix} n-1 \\ r-1 \end{matrix} \right ) p^r(1-p)^{n-r} = 1$$

## 超几何随机变量 (Hyper Geometirc)
 
设一个坛子里共有N个球，其中m个白球，N-m个黑球，从中随机地(无放回)取出n个球，令X表示取出来的白球数，若X满足

$$P\{ X=i \} = \frac {\left ( \begin{matrix} m \\ i \end{matrix} \right ) \left ( \begin{matrix} N-m \\ n-i \end{matrix} \right )}{\left ( \begin{matrix} N \\ n \end{matrix} \right )} \qquad i=0,1,2,···,n$$

则表示X是超几何随机变量

$$E(X) = \frac {nm}{N}$$

$$Var(X) = np(1-p)(1-\frac{n-1}{N-1})$$

## $\zeta 分布$

如果一个随机变量有如下概率分布：

$$P\{ X=k \} = \frac {C}{k^{\alpha+1}} \qquad k=1,2,···$$

其中$\alpha > 0$，则称该随机变量服从$\zeta$分布(也称为Zipf分布)

因为概率必等于1:

$$C = [\sum_{k=1}^{\infty}(\frac 1k)^{\alpha+1}]^{-1}$$

$\zeta 分布$ 名字由来（黎曼$\zeta$函数）：

$$\zeta(s) = 1 + (\frac 12)^s + (\frac 13)^s+ ···+ (\frac 1k)^s+···$$

## 随机变量和的期望

期望的一个重要性质是一组随机变量的和的期望与这组随机变量各自期望的和相等。

$$E(X) = \sum_{s\in S}X(s)p(s)$$

## 分布函数的性质

$F(b)$表示随机变量取值小于或等于b的概率

- $F$是一个单调非降函数
- $\lim_{b\rightarrow \infty} F(b) = 1$
- $\lim_{b\rightarrow -\infty} F(b) = 0$
- $F$是右连续的，对于任意$b$和一个单调递减收敛于$b$的序列$b_n，n\ge 1$，有$\lim_{n\rightarrow \infty}F(b_n) = F(b)$
